<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'
'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns="http://www.w3.org/1999/xhtml">
  <!-- Generated from index.th on 2007-03-28 22:27 BST -->
  <!-- with command: cd /Users/pdc/th/alleged.org.uk/pdc/2004/08;
  /Users/pdc/bin/thc -r /Users/pdc/Sites/alleged.org.uk/ -s pdc/2004/08 index.th -->
  <!-- htmlProcs.tcl version 5.1.8 -->
  <head>
    <title>Uploading from OS X - Damian Cugley - Alleged Literature</title>
    <link href="../../pdc.css" rel="alternate stylesheet" type="text/css" title="Spirals" />
    <link href="../../2005/gentium.css" rel="stylesheet" type="text/css" arg0="title=Gentium" title="Gentium" />
    <link href="../../2005/lod.css" rel="alternate stylesheet" type="text/css" title="Light on Dark" />
    
    <!--[if lte IE 6]>
    <link rel="stylesheet" type="text/css" href="../../2005/gentium-ie6.css" title="Gentium" />
    <![endif]-->
    
    <meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
  </head>
  <body>
    <p class="trail">
      <a href="../../.."><img src="../../../img/alleged-03@32x16.png" align="absmiddle" alt="Alleged Literature" width="32" height="16" border="0" /></a> &gt;&gt;
      <a href="../../">pdc</a> &gt;&gt;
      <a href="../">2004</a> &gt;&gt;
      <a href="./">08</a> &gt;&gt;
      <strong>01</strong>
    </p>
    <div id="body">
      <h1>Alleged Archive</h1>
      <p id="tagline">Damian Cugley’s web site</p>
      <div class="entry">
        <h2><a name="e20040801" id="e20040801">Uploading from OS X</a></h2>
        <p class="details">1 August 2004</p>
        <div class="details">
          <h3>Topics</h3>
          <ul class="topics">
            <li><a href="../../2003/osx.html">osx</a></li>
            <li><a href="../../2003/expect.html">expect</a></li>
            <li><a href="../../2003/tcl.html"><abbr title="Tool Command Language">Tcl</abbr></a></li>
          </ul>
        </div>
        <p class="details permalink">
          <a href="#e20040801" title="Permanent URL for this entry">#</a>
        </p>
        <div class="content">

<div></div><p class="first">If you are reading this on-line then I have finally managed to alter my
   <a href="http://expect.nist.gov/" title="Expect is a tool for automating interactive applications">Expect</a> script to work with the Mac OS X version of <code>ftp</code>. This is part
   of the long drawn-out battle to transfer my projects to my PowerBook so
   that my old desktop (circa 1998) can be repurposed.
</p>
<p>Background: The way I write this site involves creating a working copy
   on my local system, so I can check it before I upload it to the real
   server. The program for doing the upload is a <a href="http://www.tcl.tk/" title="Tcl Developer Exchange">Tcl</a> script using <a href="http://www.mel.nist.gov/msidstaff/libes/">Don
Libes</a>’s Expect extension to control the FTP program. My script walks
   the directory structure of my working copy, and issues FTP commands to
   upload the files that have been changed.
</p>
<p>I got Expect by dint of installing the new <a href="http://tcltkaqua.sourceforge.net/" title="TclTkAqua project on Sourceforge">TclTkAqua-Batteries
Included</a>
   distribution of Tcl.
</p>
<p>Apple’s FTP program (really I suppose I should say BSD’s) rather threw me because it starts in ‘passive’ mode.
   My script swiches on passive mode, since that’s generally a good idea.
   The problem
   is that <code>ftp</code> uses the same command to turn an option off (if it is on)
   as turns it on when it is off. To allow for different FTP programs to have different 
   default states, I wrote a routine that issues the
   <code>passive</code> command, and examines the resulting message to determine
   whether this resulted in switching it on or off, and reissues the
   command if necessary to get the result I want.
</p>
<p>Apple’s FTP has a cute feature that
   displays a progress indicator (a line of asterisks) as it uploads large files. My
   program interpreted the unexpected text as an error message and gave
   up.
   It took me a while to work out what was happenign because it only balked
   at large files – short transfers did not get the progress indicator.
   So today I wrote more code to try to turn this option off. 
</p>
<p>Now it works fine. Except that partway through pointlessly uploading a
   whole slew of files that are in fact already uploaded but have the wrong
   timestamps my ethernet is suddenly failing. When this happens I find I
   cannot <code>ping</code> anything on the network.  I wonder if this is a
   hardware fault, as unplugging the ethernet cable and plugging it in
   again makes the problem go away.
</p>
<p>I just managed to get it to work by running <code>ping</code> continuously in
   another window. Did this help or was it coincidence? Sigh.
</p>


        </div>
      </div>
    </div>
    <div class="links">
      <h3>Archives</h3>
      <ul>
        <li><a href="../../2006/topics.html">by topic</a></li>
        <li><a href="../../2007/03/">March 2007</a></li>
        <li><a href="../../2007/02/">February 2007</a></li>
        <li><a href="../../2006/">2006</a></li>
        <li><a href="../../2005/">2005</a></li>
        <li><a href="../../2004/">2004</a></li>
        <li><a href="../../2003/">2003</a></li>
        <li><a href="../../2002/">2002</a></li>
        <li><a href="../../2001/">2001</a></li>
        <li><a href="../../2000/">2000</a></li>
        <li><a href="../../1999/">1999</a></li>
        <li><a href="../../1998/">1998</a></li>
        <li><a href="../../1997/">1997</a></li>
      </ul>
    </div>
    <div class="links">
      <p><a title="Link to an XML summary in RSS 2.0 format" href="../../rss091.xml" type="text/xml"><img src="../../../img/xml.gif" alt="XML" width="36" height="14" border="0" /></a></p>
      <p><a title="Check this page for conformance to XHTML 1.0" href="http://validator.w3.org/check/referer"><img src="../../../img/valid-xhtml10.png" alt="Valid XHTML 1.0!" height="31" width="88" border="0" /></a></p>
      <p id="squidcredit"><a title="Background pattern taken from the squidfingers.com collection" href="http://squidfingers.com/patterns/">bg by squidfingers</a></p>
      <p id="jennicredit"><a title="Photograph used in the masthead taken by Jenni Scott in the ROTA club in April 2003" href="http://www.flickr.com/photos/jinty/">photo by Jenni Scott</a></p>
    </div>
  </body>
</html>
